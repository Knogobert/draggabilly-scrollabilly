/*!
 * Draggabilly PACKAGED v2.2.1
 * Make that shiz draggable
 * https://draggabilly.desandro.com
 * MIT license
 */

!function(e,o){"function"==typeof define&&define.amd?define(["get-size/get-size","unidragger/unidragger"],function(t,i){return o(e,t,i)}):"object"==typeof module&&module.exports?module.exports=o(e,require("get-size"),require("unidragger")):e.Draggabilly=o(e,e.getSize,e.Unidragger)}(window,function(s,h,t){"use strict";function e(t,i){for(var e in i)t[e]=i[e];return t}var o=s.jQuery;function i(t,i){this.element="string"==typeof t?document.querySelector(t):t,o&&(this.$element=o(this.element)),this.options=e({scrollSpeed:10,autoScrollThreshold:30},this.constructor.defaults),this.option(i),this._create()}var n=i.prototype=Object.create(t.prototype);i.defaults={},n.option=function(t){e(this.options,t)};var r={relative:!0,absolute:!0,fixed:!0};function a(t,i,e){return e=e||"round",i?Math[e](t/i)*i:t}return n._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=e({},this.position);var t=getComputedStyle(this.element);r[t.position]||(this.element.style.position="relative"),this.on("pointerDown",this.onPointerDown),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},n.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles(),this.options.parentScroll&&(this.options.parentScroll=isElement(this.options.parentScroll)?this.options.parentScroll:"string"==typeof this.options.parentScroll?document.querySelector(this.options.parentScroll):this.element.parentNode,this.options.parentScroll.addEventListener("scroll",this))},n.dispatchEvent=function(t,i,e){var o=[i].concat(e);this.emitEvent(t,o),this.dispatchJQueryEvent(t,i,e)},n.dispatchJQueryEvent=function(t,i,e){var o=s.jQuery;if(o&&this.$element){var n=o.Event(i);n.type=t,this.$element.trigger(n,e)}},n._getPosition=function(){var t=getComputedStyle(this.element),i=this._getPositionCoord(t.left,"width"),e=this._getPositionCoord(t.top,"height");this.position.x=isNaN(i)?0:i,this.position.y=isNaN(e)?0:e,this._addTransformPosition(t)},n._getPositionCoord=function(t,i){if(-1==t.indexOf("%"))return parseInt(t,10);var e=h(this.element.parentNode);return e?parseFloat(t)/100*e[i]:0},n._addTransformPosition=function(t){var i=t.transform;if(0===i.indexOf("matrix")){var e=i.split(","),o=0===i.indexOf("matrix3d")?12:4,n=parseInt(e[o],10),s=parseInt(e[1+o],10);this.position.x+=n,this.position.y+=s}},n.onPointerDown=function(t,i){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",t,[i])},n.dragStart=function(t,i){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.scrollOffset=this.measureScrollOffset(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.lastKnownMoveVector={x:0,y:0},this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",t,[i]),this.animate())},n.measureContainment=function(){var t=this.getContainer();if(t){var i=h(this.element),e=h(t),o=this.element.getBoundingClientRect(),n=t.getBoundingClientRect(),s=e.borderLeftWidth+e.borderRightWidth,r=e.borderTopWidth+e.borderBottomWidth,l=this.relativeStartPosition={x:o.left-(n.left+e.borderLeftWidth),y:o.top-(n.top+e.borderTopWidth)};this.containSize={width:e.width-s-l.x-i.width,height:e.height-r-l.y-i.height}}},n.getContainer=function(){var t=this.options.containment;if(t)return t instanceof HTMLElement?t:"string"==typeof t?document.querySelector(t):this.element.parentNode},n.measureScrollOffset=function(){if(this.options.parentScroll)return this.options.parentScroll=isElement(this.options.parentScroll)?this.options.parentScroll:"string"==typeof this.options.parentScroll?document.querySelector(this.options.parentScroll):this.options.parentScroll=this.element.parentNode,{top:this.options.parentScroll.scrollTop,left:this.options.parentScroll.scrollLeft}},n.onPointerMove=function(t,i,e){this.dispatchJQueryEvent("pointerMove",t,[i,e])},n.dragMove=function(t,i,e){if(this.isEnabled){isNaN(e.x)||isNaN(e.y)?e=this.lastKnownMoveVector:this.lastKnownMoveVector=e,this.checkAutoScroll(i);var o=e.x,n=e.y,s=this.options.grid,r=s&&s[0],l=s&&s[1];o=this.applyScrollOffset("x",o),n=this.applyScrollOffset("y",n),o=a(o,r),n=a(n,l),o=this.containDrag("x",o,r),n=this.containDrag("y",n,l),o="y"==this.options.axis?0:o,n="x"==this.options.axis?0:n,this.position.x=this.startPosition.x+o,this.position.y=this.startPosition.y+n,this.options.scale&&(o/=this.options.scale,n/=this.options.scale),this.dragPoint.x=o,this.dragPoint.y=n,this.dispatchEvent("dragMove",t,[i,e])}},n.checkAutoScroll=function(t){if(this.options.parentScroll&&this.options.autoScroll){var i=this.options.parentScroll.getBoundingClientRect();t.clientY-this.options.autoScrollThreshold<=i.top?this.autoScrollYDirection=-1:t.clientY+this.options.autoScrollThreshold>=i.top+i.height?this.autoScrollYDirection=1:this.autoScrollYDirection=0}else this.autoScrollYDirection=0},n.onscroll=function(t){this.isEnabled&&this.isDragging&&this.onmousemove(t)},n.applyScrollOffset=function(t,i){if(!this.options.parentScroll)return i;var e="x"==t?"left":"top";return i+(this.measureScrollOffset()[e]-this.scrollOffset[e])},n.containDrag=function(t,i,e){if(!this.options.containment)return i;var o="x"==t?"width":"height",n=a(-this.relativeStartPosition[t],e,"ceil"),s=this.containSize[o];return s=a(s,e,"floor"),Math.max(n,Math.min(s,i))},n.onPointerUp=function(t,i){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",t,[i])},n.dragEnd=function(t,i){this.isEnabled&&(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",t,[i]))},n.animate=function(){if(this.isDragging){this.performAutoScroll(),this.positionDrag();var t=this;requestAnimationFrame(function(){t.animate()})}},n.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},n.setScale=function(t){this.options.scale=t},n.getScale=function(){return this.options.scale},n.performAutoScroll=function(){1!==this.autoScrollYDirection&&-1!==this.autoScrollYDirection||(this.options.parentScroll.scrollTop=this.options.parentScroll.scrollTop+this.options.scrollSpeed*this.autoScrollYDirection)},n.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},n.staticClick=function(t,i){this.dispatchEvent("staticClick",t,[i])},n.setPosition=function(t,i){this.position.x=t,this.position.y=i,this.setLeftTop()},n.enable=function(){this.isEnabled=!0},n.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},n.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.options.parentScroll&&(this.options.parentScroll=isElement(this.options.parentScroll)?this.options.parentScroll:"string"==typeof this.options.parentScroll?document.querySelector(this.options.parentScroll):this.element.parentNode,this.options.parentScroll.addEventListener("scroll",this)),this.$element&&this.$element.removeData("draggabilly")},n._init=function(){},o&&o.bridget&&o.bridget("draggabilly",i),i});